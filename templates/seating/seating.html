{% extends "seating/seating_base.html" %}
{% block title %}
Seating
{% endblock title %}
{% block sidebar%}
ads
{% endblock sidebar %}
{% load i18n %}
{% block content %}
    <div class="row">
        <div class="col-md-9">
            {% if not seating.is_open %}
                <div class="alert alert-danger">{% trans "Seating is closed." %}</div>
            {% endif %}
            <p>Legend: </p>
            <input class="btn btn-warning" type="submit" value="Ditt sete" disabled/>
            <input class="btn btn-danger" type="submit" value="Opptatt sete" disabled/>
            <input class="btn btn-success" type="submit" value="Ledig sete" disabled/>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            {% if template %}
               {{template|safe}}
            {% else %}
            {% for s in seats %}
                    <div class="col-md-2">
                {% if s.user %}
                    {% if s.user == user %}
                        <form class="form-inline" 
                        {% if seating.is_open %}
                            action="{% url 'seat_details' seating.id s.id %}" 
                        {% endif %}
                        method="POST">
                        {% csrf_token %}
                        <input class="btn btn-warning" type="submit" value="{{ s.id }}" />
                        </form>
                    {% else %}
                        <form class="form-inline" action="{% url 'seat_details' seating.id s.id %}" method="POST">
                            {% csrf_token %}
                            <input class="btn btn-danger" type="submit" value="{{ s.id }}" title="{{s.user}}" />
                        </form>
                {% endif %}
                {% else %}
                    <form class="form-inline" 
                    {% if seating.is_open %}
                        action="{% url 'seat_details' seating.id s.id %}" 
                    {% endif %}
                    method="POST">
                    {% csrf_token %}
                        <input class="btn btn-success" type="submit" value="{{ s.id }}"/>
                    </form>
                {% endif %}
                </div>
            {% endfor %}
            {% endif %}
        </div>
        {% if info_seat %}
        <div class="col-md-3">
        	<div class="well">
                <ul class="nav nav-stacked">
            		<li><strong>Seat: </strong> {{info_seat.placement}}</li>
                    {% if info_seat.user %}
                    <li><strong>Occupied by: </strong></li>
                    <li>{{info_seat.user.first_name}} {{info_seat.user.last_name}}</li>
                    
                    {% if info_seat.user == user %}
                        <form class="form-inline" 
                        {% if seating.is_open %}
                            action="{% url 'leave_seat' info_seat.seating.id info_seat.id %}" 
                        {% endif %}
                        method="POST">
                        {% csrf_token %}
                        <input class="btn btn-warning" type="submit" value="Leave seat" />
                        </form>
                    {% else %}
                        <form class="form-inline" action="/profile/{{info_seat.user}}/" method="POST">
                            {% csrf_token %}
                            <input class="btn btn-primary" type="submit" value="View profile" title="View profile" />
                        </form>
                {% endif %}
                {% else %}
                        <form class="form-inline" 
                        {% if seating.is_open %}
                            action="{% url 'take_seat' info_seat.seating.id info_seat.id %}" 
                        {% endif %}
                        method="POST">
                        {% csrf_token %}
                        <input class="btn btn-primary" type="submit" value="Take seat" />
                        </form>
                {% endif %}
                </ul>
        	</div>
        </div>
        {% endif %}
    </div>
    
    <style>
    .col-md-2 .btn {
        width: 3.5em; height: 2em;
        }
    }
    </style>
{% endblock content %}